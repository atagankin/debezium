# -----------------------------
# Конфигурация репликации (Debezium)
# -----------------------------

wal_level = logical                     # Обязательно для логической репликации
max_wal_senders = 10                    # Количество процессов отправки WAL
max_replication_slots = 10              # Слоты для Debezium и других коннекторов
max_connections = 100                   # Увеличьте при необходимости

# -----------------------------
# Настройки производительности
# -----------------------------

shared_buffers = 1GB                    # Рекомендуется 25% от RAM
effective_cache_size = 3GB              # Рекомендуется 50-75% от RAM
maintenance_work_mem = 256MB            # Для обслуживания БД
work_mem = 16MB                         # Для сортировки и хэшей

# -----------------------------
# Настройки журналирования (WAL)
# -----------------------------

archive_mode = off                      # Если не используется архивация
wal_keep_size = 1GB                     # Минимальный объем WAL для репликации
# archive_command = 'test ! -f /path/to/archive/%f && cp %p /path/to/archive/%f'  # Раскомментировать для архивации

# -----------------------------
# Настройки подключений
# -----------------------------

listen_addresses = '*'                  # Разрешить подключения с любого IP
port = 5432                             # Стандартный порт PostgreSQL

# -----------------------------
# Дополнительные настройки
# -----------------------------

synchronous_commit = off                # Для повышения производительности (риск потери данных при сбое)
hot_standby = on                        # Разрешает чтение на репликах
log_statement = 'none'                  # Уменьшает логи (можно поставить 'ddl' для отладки)